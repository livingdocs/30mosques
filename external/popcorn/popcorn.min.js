/*
 * popcorn.js version ce66d47
 * http://popcornjs.org
 *
 * Copyright 2011, Mozilla Foundation
 * Licensed under the MIT license
 */

(function(p,q){function J(a,c){return function(){if(b.plugin.debug)return a.apply(this,arguments);try{return a.apply(this,arguments)}catch(d){b.plugin.errors.push({plugin:c,thrown:d,source:a.toString()});this.trigger("error",b.plugin.errors)}}}function C(a){a=typeof a==="string"?a:[a.language,a.region].join("-");var c=a.split("-");return{iso6391:a,language:c[0]||"",region:c[1]||""}}if(q.addEventListener){var v=Array.prototype,D=Object.prototype,E=v.forEach,K=v.slice,z=D.hasOwnProperty,F=D.toString,
L=p.Popcorn,A=/^(#([\w\-\_\.]+))$/,y=[],G=false,w={events:{hash:{},apis:{}}},H=function(){return p.requestAnimationFrame||p.webkitRequestAnimationFrame||p.mozRequestAnimationFrame||p.oRequestAnimationFrame||p.msRequestAnimationFrame||function(a){p.setTimeout(a,16)}}(),b=function(a,c){return new b.p.init(a,c||null)};b.version="ce66d47";b.isSupported=true;b.instances=[];b.p=b.prototype={init:function(a,c){var d;if(typeof a==="function")if(q.readyState==="interactive"||q.readyState==="complete")a(q,
b);else{y.push(a);if(!G){G=true;var e=function(){q.removeEventListener("DOMContentLoaded",e,false);for(var g=0,i=y.length;g<i;g++)y[g].call(q,b);y=null};q.addEventListener("DOMContentLoaded",e,false)}}else{this.media=(d=A.exec(a))&&d.length&&d[2]?q.getElementById(d[2]):a;this[this.media.nodeName&&this.media.nodeName.toLowerCase()||"video"]=this.media;b.instances.push(this);this.options=c||{};this.isDestroyed=false;this.data={disabled:[],events:{},hooks:{},history:[],state:{volume:this.media.volume},
trackRefs:{},trackEvents:{byStart:[{start:-1,end:-1}],byEnd:[{start:-1,end:-1}],animating:[],startIndex:0,endIndex:0,previousUpdateTime:-1}};var f=function(g){var i,l;if(g.media.readyState>=2){i=g.media.duration;i=i!=i?Number.MAX_VALUE:i+1;b.addTrackEvent(g,{start:i,end:i});if(g.options.frameAnimation){l=function(){b.timeUpdate(g,{});g.trigger("timeupdate");H(l)};H(l)}else{g.data.timeUpdateFunction=function(n){b.timeUpdate(g,n)};g.isDestroyed||g.media.addEventListener("timeupdate",g.data.timeUpdateFunction,
false)}}else p.setTimeout(function(){f(g)},1)};f(this);return this}}};b.p.init.prototype=b.p;b.forEach=function(a,c,d){if(!a||!c)return{};d=d||this;var e,f;if(E&&a.forEach===E)return a.forEach(c,d);if(F.call(a)==="[object NodeList]"){e=0;for(f=a.length;e<f;e++)c.call(d,a[e],e,a);return a}for(e in a)z.call(a,e)&&c.call(d,a[e],e,a);return a};b.extend=function(a){var c=K.call(arguments,1);b.forEach(c,function(d){for(var e in d)a[e]=d[e]});return a};b.extend(b,{noConflict:function(a){if(a)p.Popcorn=L;
return b},error:function(a){throw Error(a);},guid:function(a){b.guid.counter++;return(a?a:"")+(+new Date+b.guid.counter)},sizeOf:function(a){var c=0,d;for(d in a)c++;return c},isArray:Array.isArray||function(a){return F.call(a)==="[object Array]"},nop:function(){},position:function(a){a=a.getBoundingClientRect();var c={},d=q.documentElement,e=q.body,f,g,i;f=d.clientTop||e.clientTop||0;g=d.clientLeft||e.clientLeft||0;i=p.pageYOffset&&d.scrollTop||e.scrollTop;d=p.pageXOffset&&d.scrollLeft||e.scrollLeft;
f=Math.ceil(a.top+i-f);g=Math.ceil(a.left+d-g);for(var l in a)c[l]=Math.round(a[l]);return b.extend({},c,{top:f,left:g})},disable:function(a,c){var d=a.data.disabled;d.indexOf(c)===-1&&d.push(c);return a},enable:function(a,c){var d=a.data.disabled,e=d.indexOf(c);e>-1&&d.splice(e,1);return a},destroy:function(a){var c=a.data.events,d,e,f;for(e in c){d=c[e];for(f in d)delete d[f];c[e]=null}if(!a.isDestroyed){a.media.removeEventListener("timeupdate",a.data.timeUpdateFunction,false);a.isDestroyed=true}}});
b.guid.counter=1;b.extend(b.p,function(){var a={};b.forEach("load play pause currentTime playbackRate volume duration preload playbackRate autoplay loop controls muted buffered readyState seeking paused played seekable ended".split(/\s+/g),function(c){a[c]=function(d){if(typeof this.media[c]==="function"){if(d!=null&&/play|pause/.test(c))this.media.currentTime=b.util.toSeconds(d);this.media[c]();return this}if(d!=null){this.media[c]=d;return this}return this.media[c]}});return a}());b.forEach("enable disable".split(" "),
function(a){b.p[a]=function(c){return b[a](this,c)}});b.extend(b.p,{roundTime:function(){return-~this.media.currentTime},exec:function(a,c){b.addTrackEvent(this,{start:a,end:a+1,_running:false,_natives:{start:c||b.nop,end:b.nop,type:"exec"}});return this},mute:function(a){a=a==null||a===true?"muted":"unmuted";if(a==="unmuted"){this.media.muted=false;this.media.volume=this.data.state.volume}if(a==="muted"){this.data.state.volume=this.media.volume;this.media.muted=true}this.trigger(a);return this},
unmute:function(a){return this.mute(a==null?false:!a)},position:function(){return b.position(this.media)},toggle:function(a){return b[this.data.disabled.indexOf(a)>-1?"enable":"disable"](this,a)},defaults:function(a,c){if(b.isArray(a)){b.forEach(a,function(d){for(var e in d)this.defaults(e,d[e])},this);return this}if(!this.options.defaults)this.options.defaults={};this.options.defaults[a]||(this.options.defaults[a]={});b.extend(this.options.defaults[a],c);return this}});b.Events={UIEvents:"blur focus focusin focusout load resize scroll unload",
MouseEvents:"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave click dblclick",Events:"loadstart progress suspend emptied stalled play pause loadedmetadata loadeddata waiting playing canplay canplaythrough seeking seeked timeupdate ended ratechange durationchange volumechange"};b.Events.Natives=b.Events.UIEvents+" "+b.Events.MouseEvents+" "+b.Events.Events;w.events.apiTypes=["UIEvents","MouseEvents","Events"];(function(a,c){for(var d=w.events.apiTypes,e=a.Natives.split(/\s+/g),
f=0,g=e.length;f<g;f++)c.hash[e[f]]=true;d.forEach(function(i){c.apis[i]={};for(var l=a[i].split(/\s+/g),n=l.length,k=0;k<n;k++)c.apis[i][l[k]]=true})})(b.Events,w.events);b.events={isNative:function(a){return!!w.events.hash[a]},getInterface:function(a){if(!b.events.isNative(a))return false;var c=w.events,d=c.apiTypes;c=c.apis;for(var e=0,f=d.length,g,i;e<f;e++){i=d[e];if(c[i][a]){g=i;break}}return g},all:b.Events.Natives.split(/\s+/g),fn:{trigger:function(a,c){var d;if(this.data.events[a]&&b.sizeOf(this.data.events[a])){if(d=
b.events.getInterface(a)){d=q.createEvent(d);d.initEvent(a,true,true,p,1);this.media.dispatchEvent(d);return this}b.forEach(this.data.events[a],function(e){e.call(this,c)},this)}return this},listen:function(a,c){var d=this,e=true,f=b.events.hooks[a],g;if(!this.data.events[a]){this.data.events[a]={};e=false}if(f){f.add&&f.add.call(this,{},c);if(f.bind)a=f.bind;if(f.handler){g=c;c=function(i){f.handler.call(d,i,g)}}e=true;if(!this.data.events[a]){this.data.events[a]={};e=false}}this.data.events[a][c.name||
c.toString()+b.guid()]=c;!e&&b.events.all.indexOf(a)>-1&&this.media.addEventListener(a,function(i){b.forEach(d.data.events[a],function(l){typeof l==="function"&&l.call(d,i)})},false);return this},unlisten:function(a,c){if(this.data.events[a]&&this.data.events[a][c]){delete this.data.events[a][c];return this}this.data.events[a]=null;return this}},hooks:{canplayall:{bind:"canplaythrough",add:function(a,c){var d=false;if(this.media.readyState){c.call(this,a);d=true}this.data.hooks.canplayall={fired:d}},
handler:function(a,c){if(!this.data.hooks.canplayall.fired){c.call(this,a);this.data.hooks.canplayall.fired=true}}}}};b.forEach(["trigger","listen","unlisten"],function(a){b.p[a]=b.events.fn[a]});b.addTrackEvent=function(a,c){if(c&&c._natives&&c._natives.type&&a.options.defaults&&a.options.defaults[c._natives.type])c=b.extend({},a.options.defaults[c._natives.type],c);if(c._natives){c._id=!c.id?b.guid(c._natives.type):c.id;a.data.history.push(c._id)}c.start=b.util.toSeconds(c.start,a.options.framerate);
c.end=b.util.toSeconds(c.end,a.options.framerate);var d=a.data.trackEvents.byStart,e=a.data.trackEvents.byEnd,f;for(f=d.length-1;f>=0;f--)if(c.start>=d[f].start){d.splice(f+1,0,c);break}for(f=e.length-1;f>=0;f--)if(c.end>e[f].end){e.splice(f+1,0,c);break}this.timeUpdate(a,null);c._id&&b.addTrackEvent.ref(a,c)};b.addTrackEvent.ref=function(a,c){a.data.trackRefs[c._id]=c;return a};b.removeTrackEvent=function(a,c){var d=a.data.history.length,e=0,f=[],g=[],i=[],l=[];b.forEach(a.data.trackEvents.byStart,
function(k,h){if(!k._id){f.push(a.data.trackEvents.byStart[h]);g.push(a.data.trackEvents.byEnd[h])}if(k._id){if(k._id!==c){f.push(a.data.trackEvents.byStart[h]);g.push(a.data.trackEvents.byEnd[h])}if(k._id===c){e=h;k._natives._teardown&&k._natives._teardown.call(a,k)}}});a.data.trackEvents.animating.length&&b.forEach(a.data.trackEvents.animating,function(k,h){k._id||i.push(a.data.trackEvents.animating[h]);k._id&&k._id!==c&&i.push(a.data.trackEvents.animating[h])});e<=a.data.trackEvents.startIndex&&
a.data.trackEvents.startIndex--;e<=a.data.trackEvents.endIndex&&a.data.trackEvents.endIndex--;a.data.trackEvents.byStart=f;a.data.trackEvents.byEnd=g;a.data.trackEvents.animating=i;for(var n=0;n<d;n++)a.data.history[n]!==c&&l.push(a.data.history[n]);a.data.history=l;b.removeTrackEvent.ref(a,c)};b.removeTrackEvent.ref=function(a,c){delete a.data.trackRefs[c];return a};b.getTrackEvents=function(a){var c=[];a=a.data.trackEvents.byStart;for(var d=a.length,e=0,f;e<d;e++){f=a[e];f._id&&c.push(f)}return c};
b.getTrackEvents.ref=function(a){return a.data.trackRefs};b.getTrackEvent=function(a,c){return a.data.trackRefs[c]};b.getTrackEvent.ref=function(a,c){return a.data.trackRefs[c]};b.getLastTrackEventId=function(a){return a.data.history[a.data.history.length-1]};b.timeUpdate=function(a,c){var d=a.media.currentTime,e=a.data.trackEvents.previousUpdateTime,f=a.data.trackEvents,g=f.animating,i=f.endIndex,l=f.startIndex,n=0,k=b.registryByName,h,j;if(e<=d){for(;f.byEnd[i]&&f.byEnd[i].end<=d;){h=f.byEnd[i];
j=(e=h._natives)&&e.type;if(!e||k[j]||a[j]){if(h._running===true){h._running=false;e.end.call(a,c,h)}i++}else{b.removeTrackEvent(a,h._id);return}}for(;f.byStart[l]&&f.byStart[l].start<=d;){h=f.byStart[l];j=(e=h._natives)&&e.type;if(!e||k[j]||a[j]){if(h.end>d&&h._running===false&&a.data.disabled.indexOf(j)===-1){h._running=true;e.start.call(a,c,h);a.options.frameAnimation&&h&&h._running&&h._natives.frame&&g.push(h)}l++}else{b.removeTrackEvent(a,h._id);return}}if(a.options.frameAnimation)for(;n<g.length;){k=
g[n];if(k._running){k._natives.frame.call(a,c,k,d);n++}else g.splice(n,1)}}else if(e>d){for(;f.byStart[l]&&f.byStart[l].start>d;){h=f.byStart[l];j=(e=h._natives)&&e.type;if(!e||k[j]||a[j]){if(h._running===true){h._running=false;e.end.call(a,c,h)}l--}else{b.removeTrackEvent(a,h._id);return}}for(;f.byEnd[i]&&f.byEnd[i].end>d;){h=f.byEnd[i];j=(e=h._natives)&&e.type;if(!e||k[j]||a[j]){if(h.start<=d&&h._running===false&&a.data.disabled.indexOf(j)===-1){h._running=true;e.start.call(a,c,h);a.options.frameAnimation&&
h&&h._running&&h._natives.frame&&g.push(h)}i--}else{b.removeTrackEvent(a,h._id);return}}if(a.options.frameAnimation)for(;n<g.length;){k=g[n];if(k._running){k._natives.frame.call(a,c,k,d);n++}else g.splice(n,1)}}f.endIndex=i;f.startIndex=l;f.previousUpdateTime=d};b.extend(b.p,{getTrackEvents:function(){return b.getTrackEvents.call(null,this)},getTrackEvent:function(a){return b.getTrackEvent.call(null,this,a)},getLastTrackEventId:function(){return b.getLastTrackEventId.call(null,this)},removeTrackEvent:function(a){b.removeTrackEvent.call(null,
this,a);return this},removePlugin:function(a){b.removePlugin.call(null,this,a);return this},timeUpdate:function(a){b.timeUpdate.call(null,this,a);return this},destroy:function(){b.destroy.call(null,this);return this}});b.manifest={};b.registry=[];b.registryByName={};b.plugin=function(a,c,d){if(b.protect.natives.indexOf(a.toLowerCase())>=0)b.error("'"+a+"' is a protected function name");else{var e=["start","end"],f={},g=typeof c==="function",i=["_setup","_teardown","start","end","frame"],l=function(h,
j){h=h||b.nop;j=j||b.nop;return function(){h.apply(this,arguments);j.apply(this,arguments)}};b.manifest[a]=d=d||c.manifest||{};i.forEach(function(h){c[h]=J(c[h]||b.nop,a)});var n=function(h,j){if(!j)return this;var r=j._natives={},m="",s,u;b.extend(r,h);j._natives.type=a;j._running=false;r.start=r.start||r["in"];r.end=r.end||r.out;s=this.options.defaults&&this.options.defaults[j._natives&&j._natives.type];j.compose=j.compose&&j.compose.split(" ")||[];j.effect=j.effect&&j.effect.split(" ")||[];j.compose=
j.compose.concat(j.effect);j.compose.forEach(function(o){m=b.compositions[o]||{};i.forEach(function(t){r[t]=l(r[t],m[t])})});j._natives.manifest=d;if(!("start"in j))j.start=j["in"]||0;if(!("end"in j))j.end=j.out||this.duration()||Number.MAX_VALUE;u=s?b.extend({},s,j):j;if(!u.target){s="options"in d&&d.options;u.target=s&&"target"in s&&s.target}j._natives._setup&&j._natives._setup.call(this,u);b.addTrackEvent(this,b.extend(u,j));b.forEach(h,function(o,t){t!=="type"&&e.indexOf(t)===-1&&this.listen(t,
o)},this);return this};f[a]=function(h){return n.call(this,g?c.call(this,h):c,h)};b.extend(b.p,f);var k={fn:f[a],definition:c,base:c,parents:[],name:a};b.registry.push(b.extend(f,k,{type:a}));b.registryByName[a]=k;return f}};b.plugin.errors=[];b.plugin.debug=false;b.removePlugin=function(a,c){if(!c){c=a;a=b.p;if(b.protect.natives.indexOf(c.toLowerCase())>=0){b.error("'"+c+"' is a protected function name");return}var d=b.registry.length,e;for(e=0;e<d;e++)if(b.registry[e].name===c){b.registry.splice(e,
1);delete b.registryByName[c];delete a[c];return}}d=a.data.trackEvents.byStart;e=a.data.trackEvents.byEnd;var f=a.data.trackEvents.animating,g,i;g=0;for(i=d.length;g<i;g++)if(d[g]&&d[g]._natives&&d[g]._natives.type===c&&e[g]&&e[g]._natives&&e[g]._natives.type===c){d[g]._natives._teardown&&d[g]._natives._teardown.call(a,d[g]);d.splice(g,1);e.splice(g,1);g--;i--;if(a.data.trackEvents.startIndex<=g){a.data.trackEvents.startIndex--;a.data.trackEvents.endIndex--}}g=0;for(i=f.length;g<i;g++)if(f[g]&&f[g]._natives&&
f[g]._natives.type===c){f.splice(g,1);g--;i--}};b.compositions={};b.compose=function(a,c,d){b.manifest[a]=d||c.manifest||{};b.compositions[a]=c};b.plugin.effect=b.effect=b.compose;b.parsers={};b.parser=function(a,c,d){if(b.protect.natives.indexOf(a.toLowerCase())>=0)b.error("'"+a+"' is a protected function name");else{if(typeof c==="function"&&!d){d=c;c=""}if(!(typeof d!=="function"||typeof c!=="string")){var e={};e[a]=function(f,g){if(!f)return this;var i=this;b.xhr({url:f,dataType:c,success:function(l){var n,
k,h=0;l=d(l).data||[];if(n=l.length){for(;h<n;h++){k=l[h];for(var j in k)z.call(k,j)&&i[j]&&i[j](k[j])}g&&g()}}});return this};b.extend(b.p,e);return e}}};b.player=function(a,c){c=c||{};var d=function(e,f,g){g=g||{};var i=new Date/1E3,l=i,n=0,k=1,h=false,j={},r=q.getElementById(A.exec(e)&&A.exec(e)[2])||q.getElementById(e)||e,m={},s;for(s in r)if(typeof r[s]==="object")m[s]=r[s];else if(typeof r[s]==="function")m[s]=function(o){return function(){return r[o].apply(r,arguments)}}(s);else b.player.defineProperty(m,
s,{get:function(o){return function(){return r[o]}}(s),set:b.nop,configurable:true});var u=function(){i=new Date/1E3;if(!m.paused){m.currentTime+=i-l;m.dispatchEvent("timeupdate");setTimeout(u,10)}l=i};m.play=function(){this.paused=false;if(m.readyState>=4){l=new Date/1E3;m.dispatchEvent("play");u()}};m.pause=function(){this.paused=true;m.dispatchEvent("pause")};b.player.defineProperty(m,"currentTime",{get:function(){return n},set:function(o){n=+o;m.dispatchEvent("timeupdate");return n},configurable:true});
b.player.defineProperty(m,"volume",{get:function(){return k},set:function(o){k=+o;m.dispatchEvent("volumechange");return k},configurable:true});b.player.defineProperty(m,"muted",{get:function(){return h},set:function(o){h=+o;m.dispatchEvent("volumechange");return h},configurable:true});m.addEventListener=function(o,t){j[o]||(j[o]=[]);j[o].push(t);return t};m.dispatchEvent=function(o){var t,I=this,x=o.type;if(!x){x=o;if(o=b.events.getInterface(x)){t=q.createEvent(o);t.initEvent(x,true,true,window,
1)}}b.forEach(j[x],function(M){M.call(I,t,I)})};m.src=f||"";m.readyState=0;m.duration=0;m.paused=true;m.ended=0;if(c._setup)c._setup.call(m,g);else{m.readyState=4;m.dispatchEvent("load");m.dispatchEvent("loadeddata")}m.addEventListener("load",function(){m.currentTime=n;m.volume=k;m.muted=h});m.addEventListener("loadeddata",function(){!m.paused&&m.play()});return new b.p.init(m,g)};b[a]=b[a]||d};b.player.defineProperty=Object.defineProperty||function(a,c,d){a.__defineGetter__(c,d.get||b.nop);a.__defineSetter__(c,
d.set||b.nop)};var N=/\?/,O={url:"",data:"",dataType:"",success:b.nop,type:"GET",async:true,xhr:function(){return new p.XMLHttpRequest}};b.xhr=function(a){a.dataType=a.dataType&&a.dataType.toLowerCase()||null;if(a.dataType&&(a.dataType==="jsonp"||a.dataType==="script"))b.xhr.getJSONP(a.url,a.success,a.dataType==="script");else{a=b.extend({},O,a);a.ajax=a.xhr();if(a.ajax){if(a.type==="GET"&&a.data){a.url+=(N.test(a.url)?"&":"?")+a.data;a.data=null}a.ajax.open(a.type,a.url,a.async);a.ajax.send(a.data||
null);return b.xhr.httpData(a)}}};b.xhr.httpData=function(a){var c,d=null;a.ajax.onreadystatechange=function(){if(a.ajax.readyState===4){try{d=JSON.parse(a.ajax.responseText)}catch(e){}c={xml:a.ajax.responseXML,text:a.ajax.responseText,json:d};if(a.dataType)c=c[a.dataType];a.success.call(a.ajax,c)}};return c};b.xhr.getJSONP=function(a,c,d){var e=q.head||q.getElementsByTagName("head")[0]||q.documentElement,f=q.createElement("script"),g=a.split("?")[1],i=false,l=[],n,k;if(g&&!d)l=g.split("&");if(l.length)k=
l[l.length-1].split("=");n=l.length?k[1]?k[1]:k[0]:"jsonp";if(!g&&!d)a+="?callback="+n;if(n&&!d){if(window[n])n=b.guid(n);window[n]=function(h){c&&c(h);i=true};a=a.replace(k.join("="),k[0]+"="+n)}f.onload=function(){d&&c&&c();i&&delete window[n];e.removeChild(f)};f.src=a;e.insertBefore(f,e.firstChild)};b.getJSONP=b.xhr.getJSONP;b.getScript=b.xhr.getScript=function(a,c){return b.xhr.getJSONP(a,c,true)};b.util={toSeconds:function(a,c){var d=/^([0-9]+:){0,2}[0-9]+([.;][0-9]+)?$/,e,f,g;if(typeof a===
"number")return a;typeof a==="string"&&!d.test(a)&&b.error("Invalid time format");d=a.split(":");e=d.length-1;f=d[e];if(f.indexOf(";")>-1){f=f.split(";");g=0;if(c&&typeof c==="number")g=parseFloat(f[1],10)/c;d[e]=parseInt(f[0],10)+g}e=d[0];return{1:parseFloat(e,10),2:parseInt(e,10)*60+parseFloat(d[1],10),3:parseInt(e,10)*3600+parseInt(d[1],10)*60+parseFloat(d[2],10)}[d.length||1]}};var B=C(p.navigator.userLanguage||p.navigator.language);b.locale={get:function(){return B},set:function(a){B=C(a);b.locale.broadcast();
return B},broadcast:function(a){var c=b.instances,d=c.length,e=0,f;for(a=a||"locale:changed";e<d;e++){f=c[e];a in f.data.events&&f.trigger(a)}}};b.p.cue=b.p.exec;b.protect={natives:function(){var a,c=[];if(Object.keys)c=Object.keys(b.p);else for(a in b.p)z.call(b.p,a)&&c.push(a);return c.join(",").toLowerCase().split(",")}()};p.Popcorn=b}else{p.Popcorn={isSupported:false};for(v="forEach extend effects error guid sizeOf isArray nop position disable enable destroy addTrackEvent removeTrackEvent getTrackEvents getTrackEvent getLastTrackEventId timeUpdate plugin removePlugin compose effect parser xhr getJSONP getScript".split(/\s+/);v.length;)p.Popcorn[v.shift()]=
function(){}}})(window,window.document);
